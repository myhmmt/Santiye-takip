<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Vista Premium – Şantiye Takip v1.5</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json?v=1.5" />
  <meta name="theme-color" content="#0d47a1" />
  <!-- iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="apple-touch-icon" sizes="152x152" href="assets/icon/apple-icon-152.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="assets/icon/apple-icon-180.png" />

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet" />

  <link rel="stylesheet" href="./style.css?v=1.5" />
</head>
<body>
  <div class="app-container">
    <!-- HEADER -->
    <header class="app-header">
      <h1>Vista Premium – Şantiye Takip <span class="ver">v1.5</span></h1>
      <p class="sub-info">Muhammet Genç tarafından geliştirilmiştir.</p>
    </header>

    <main class="app-main">
      <!-- Bölüm 1: Günlük Yoklama -->
      <section id="bolum1" class="page">
        <h2>Bölüm 1: Günlük Yoklama</h2>
        <form id="formYoklama" class="card">
          <div class="form-group">
            <label for="yoklamaEkip">Ekip Seçimi</label>
            <select id="yoklamaEkip"></select>
          </div>
          <div class="form-group">
            <label for="yoklamaKisi">Kişi Sayısı</label>
            <input type="number" id="yoklamaKisi" placeholder="Örn: 5" min="1" />
          </div>
          <div class="form-group">
            <label for="yoklamaBlok">Blok Seçimi</label>
            <div class="inline">
              <select id="yoklamaBlok" class="flex1"></select>
              <button type="button" id="btnPaftaYoklama" class="btn btn-secondary"><i class="fa-solid fa-map"></i> Paftadan Seç</button>
            </div>
          </div>
          <div class="form-group">
            <label for="yoklamaNot">Not (Opsiyonel)</label>
            <textarea id="yoklamaNot" rows="3"></textarea>
          </div>
          <button type="submit" class="btn btn-primary"><i class="fa-solid fa-user-check"></i> Giriş Yap</button>
        </form>

        <div class="ozet-panel card">
          <h3>Bugünkü Yoklama Özeti</h3>
          <ul id="yoklamaListesi" class="list-plain"></ul>
        </div>
      </section>

      <!-- Bölüm 2: Hızlı Kayıt -->
      <section id="bolum2" class="page">
        <h2>Bölüm 2: Hızlı Kayıt (İmalat Girişi)</h2>
        <form id="formHizliKayit" class="card">
          <div class="form-group">
            <label for="kayitKullanici">Kullanıcı</label>
            <select id="kayitKullanici"></select>
          </div>
          <div class="form-group">
            <label for="kayitEkip">İmalat Kalemi</label>
            <select id="kayitEkip"></select>
          </div>
          <div class="form-group">
            <label for="kayitBlok">Blok Seçimi</label>
            <div class="inline">
              <select id="kayitBlok" class="flex1"></select>
              <button type="button" id="btnPaftaKayit" class="btn btn-secondary"><i class="fa-solid fa-map"></i> Paftadan Seç</button>
            </div>
          </div>
          <div class="form-group">
            <label for="kayitDurum">Durum</label>
            <select id="kayitDurum">
              <option value="Baslanmadi">Başlanmadı</option>
              <option value="Basladi">Başladı</option>
              <option value="Devam">Devam Ediyor</option>
              <option value="Bitti">Bitti</option>
              <option value="Teslim">Teslim Alındı</option>
            </select>
            <p class="form-msg">Not: Başladı ve Devam Ediyor aynı renktir (sarı).</p>
          </div>
          <div class="form-group">
            <label for="kayitNot">Not (Opsiyonel)</label>
            <textarea id="kayitNot" rows="3"></textarea>
          </div>
          <button type="submit" class="btn btn-primary"><i class="fa-solid fa-floppy-disk"></i> Kaydet</button>
        </form>

        <!-- Hızlı Kayıt Arşivi (Bölüm 2’de) -->
        <div id="hizliKayitArsivi" class="card">
          <h3>Hızlı Kayıt Arşivi (Tüm İmalatlar)</h3>
          <div class="table-responsive">
            <table id="arsivTablosu">
              <thead>
                <tr>
                  <th>Tarih</th>
                  <th>Kullanıcı</th>
                  <th>Ekip</th>
                  <th>Blok</th>
                  <th>Durum</th>
                  <th>Not</th>
                  <th>İşlem</th>
                </tr>
              </thead>
              <tbody id="arsivBody"></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Bölüm 3: Pano -->
      <section id="bolum3" class="page active">
        <div class="head-row">
          <h2>Bölüm 3: Proje Durum Panosu</h2>
          <button id="btnPdfIcmal" class="btn btn-primary"><i class="fa-solid fa-file-pdf"></i> İcmal PDF Al</button>
        </div>

        <!-- Çoklu Pafta: her ekip için bir pafta (sırayla) -->
        <div id="multiPafta"></div>
      </section>
    </main>

    <!-- Alt Menü -->
    <nav class="app-nav">
      <button class="nav-btn" data-page="bolum1"><i class="fas fa-user-check"></i><span>Yoklama</span></button>
      <button class="nav-btn" data-page="bolum2"><i class="fas fa-plus-circle"></i><span>Hızlı Kayıt</span></button>
      <button class="nav-btn active" data-page="bolum3"><i class="fas fa-th-large"></i><span>Ana Pano</span></button>
    </nav>
  </div>

  <!-- Modal: Paftadan Seç -->
  <div class="modal" id="modal">
    <div class="backdrop" id="modalBackdrop"></div>
    <div class="sheet">
      <div class="top">
        <h3>Paftadan Blok Seç</h3>
        <button class="btn close" id="btnClose"><i class="fa-solid fa-xmark"></i> Kapat</button>
      </div>
      <p class="help">Bir bloğa dokunduğunda seçili form alanına aktarılır.</p>
      <div class="pafta-scroll">
        <div class="pafta-row" id="m-top"></div>
        <div class="pafta-row" id="m-mid"></div>
        <div class="pafta-row" id="m-bot"></div>
      </div>
    </div>
  </div>

  <!-- Print Alanı (yeni pencerede üretilecek) -->
  <template id="tpl-icmal">
    <style>
      body{font-family:Roboto,Arial,sans-serif;margin:24px}
      h2{margin:0 0 12px}
      .pafta-wrap{margin:10px 0 20px}
      .pafta-title{font-weight:700;margin:6px 0}
      .row{display:flex;gap:8px;flex-wrap:nowrap;overflow:hidden}
      .blk{flex:0 0 36px;height:36px;border:1px solid #bbb;border-radius:6px;display:flex;align-items:center;justify-content:center;font:700 12px/1 Roboto}
      .as{position:relative}
      .as::after{content:attr(data-own);position:absolute;left:2px;bottom:2px;font:700 9px/1 Roboto;padding:1px 3px;border:1px solid #bbb;border-radius:4px;background:#fff}
      table{width:100%;border-collapse:collapse;margin-top:8px;font-size:12.5px}
      th,td{border:1px solid #bbb;padding:6px}
      thead{background:#f1f5f9}
      tfoot td{font-weight:700;background:#f9fafb}
    </style>
    <h2>Şantiye İlerleme İcmali — Vista Premium</h2>
    <div id="printPaftalar"></div>
    <div id="printTable"></div>
  </template>

  <!-- App -->
  <script type="module" src="./app.js?v=1.5" defer></script>
</body>
</html>
